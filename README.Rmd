<!-- README.md is generated from README.Rmd. Please edit that file -->
```{r, echo = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path='figures/README-'
)
```
#tableMatrix

`tableMatrix` package provides structures to store data. First one is tableList which only serves to wrap data.table and additional structures together, second is tableMatrix that combines useful features of data.table and matrix to gain faster access to data.

##Installation
From github:
```{r eval=FALSE}
# install.packages("devtools")
devtools::install_github("InferenceTechnologies/tableMatrix")
```

##Motivation

###tableList
It is needed to wrap a data.table object and other structures together and preserve data.table behaviour.

####Example
Dataset and linear model stored in tableList.

```{r}
data(chickwts)
tl <- tableList(chickwts, lm(weight~feed, chickwts))

mean(tl[feed=="casein", weight])

aid(tl)
```

###tableMatrix
Lets have dataset which consists of two parts - metadata columns (any types) and main data columns (only one type). If whole data were stored as data.table (data.frame), access to main part would be much slower (slow indexing in data.table). 
`tableMatrix` is result for this. It combines best of data.table (access via bracket to metadata part) and matrix. It stores dimensions of main part and effectively use this information while using multiple datasets which can have different dimensions of main data. It also can store additional structures.

####Example
Solving simple task - recreating pictures from data with `tableMatrix`. Used datasets (images8By8, images15By15) are bitmaps. 

```{r}
data(images8By8)
colnames(images8By8)
dim(images8By8)
data(images15By15)
dim(images15By15)

tm <- tableMatrix(list(images15By15, images8By8),
list(1:3, 1:3), list(c(4:ncol(images15By15)),c(4:ncol(images8By8))), list(c(15,15), c(8,8)))

#metadata
tab(tm)

#dimensions of main data
matDim(tm)

#additional structures - now empty
aid(tm)

length(mat(tm))

#subsetting via bracket passed to metadata part
tabSub <- tm[.(2)][direction=="both"]

length(mat(tabSub))

#recreating heat map
imageMean <- colMeans(mat(tabSub,1))

dim(imageMean) <- getRowDim(tabSub,1)

image(imageMean)
```

